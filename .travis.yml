language: ruby
rvm:
- 2.2.0
env:
  global:
  - ARTIFACTS_AWS_REGION=us-east-1
  - ARTIFACTS_S3_BUCKET=ga-wdi-travis-logs
  - secure: FPrIUS+n3uy6/S2ymifp4HgNrogQff3oq5ctnt1Mavd9XUMZFuiG5zXJ92ok0eb3KJBB7gFdAKLYEVSsHb54f3JqG4exAgtNuC/Wr72DgiHpnQnWpkaDJsuZzSOZ4BN4v3juI2JyWnjIfabig7Rf/E7haQOaJHSiATaAvxWX0nY=
  - secure: RTiMnOTBrqhZKilRf7GHViaIOsxB0eR/LegzhDXx/BjOd1u+lwnKnKXEQd2Mlw8wYTiUyuznlpKxaj6K/rgSKKjdYLifyQ4mx+tlfE8xQQBVRkBjL4LixmYuvGyMIFU1fs67+oltWGPtgTjVOy7jRVlfXmOBzYJqiE5BZpN57I4=
script:
- bundle exec rspec spec
before_script:
- gem install travis-artifacts
- cp config/database.yml.travis config/database.yml
- psql -c 'create database travis_ci_test' -U postgres
deploy:
  provider: heroku
  app: gradingwizard
  api_key:
    secure: QQCQXZWK8cPY+CSMYXz0utXSp7TsFRuqbEyFur3D2IEauGoE5obIuaxh0MJNcsCo+sm3XebphrCaTlocjy68Kzw8ghEg8TGnPZv/Mb+yaF0j3avA1FqzWpMSnApOEdW24ZU7a5wsGPpTGuI9LmD4o++yeeZax2EfKxmyGpMyKrg=
  run:
  - rake db:migrate
  - rake db:seed
  - restart
addons:
  artifacts:
    debug: true
    bucket: "ga-wdi-travis-logs/artifacts"
    secret:
      secure: EmmLiXpnS2y5Nm1Mi83HJI7ZAtfGGTgadvFHNAgszrxYDxj+v4uICzNfZg1t5gPk1jhMpqdPZ/94JUzOPrzYvkQ+n5zqTDTDqiCNBSAqHh4wBhhdh8qQ9szIYJqz3apkmOw4dsNLINVYHbc9nk0HyY47gI/4w7nkJ7+wkX6z/ro=
    key:
      secure: V7eTwg944O+MXLJ7gAEQsaGj7k360LGBgsRVvWoiQIrvExTJmcLtzZuYE8g4tui4FyxoZu1zJoOcdrxmF/dSKec2lDFdunCFt0STR57dy6tz76MF60P48hD/tb4YxDzweIurEUUXuq5aSsLCZbCfzkJ+O4MsfWzHYQNudMx5cKM=
